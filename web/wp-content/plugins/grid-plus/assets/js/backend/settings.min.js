var GridPlusSetting=GridPlusSetting||{};!function(a){"use strict";GridPlusSetting={vars:{grid_stack:a(".grid-stack")},init:function(){a(".grid-plus-wrap").css("opacity",1),GridPlusSetting.grid=null,GridPlusSetting.is_search=0,GridPlusSetting.options={cellHeight:10,verticalMargin:20,height:0,animate:!0,acceptWidgets:!0,removable:!0,width:12,resizable:{handles:"e, se, s, sw, w"}},GridPlusSetting.select_categories=null,GridPlusSetting.initControl(),GridPlusSetting.registerEvent(),GridPlusSetting.animation(),GridPlusSetting.initDepend(),GridPlusSetting.initSaveCtrS(),new Clipboard(".copy-clipboard").on("success",function(b){a(b.trigger).find("i.fa-check").length>0&&a(b.trigger).find("i.fa-check").remove(),a(b.trigger).append('<i class="fa fa-check active"> Copied!</i>'),b.clearSelection(),setTimeout(function(){a("i.active",b.trigger).fadeOut(function(){a(this).remove()})},2e3)}),a(".colorpicker").wpColorPicker(),GridPlusSetting.layout_custom_css=ace.edit("layout_custom_css"),GridPlusSetting.layout_custom_css.getSession().setMode("ace/mode/css"),GridPlusSetting.layout_custom_css.setAutoScrollEditorIntoView(!0),"undefined"!=typeof grid_script_data&&""!=grid_script_data.grid_id&&GridPlusSetting.processEditLayout()},initControl:function(){GridPlusSetting.layout_id=a("#layout_id"),GridPlusSetting.layout_shortcode=a("#layout_shortcode"),GridPlusSetting.layout_name=a("#layout_name"),GridPlusSetting.layout_type=a("#layout_type"),GridPlusSetting.layout_col=a("#layout_col"),GridPlusSetting.layout_gutter=a("#layout_gutter"),GridPlusSetting.layout_item_per_page=a("#layout_item_per_page"),GridPlusSetting.layout_total_items=a("#layout_total_items"),GridPlusSetting.layout_fix_item_height=a("#layout_fix_item_height"),GridPlusSetting.layout_crop_image=a("#layout_crop_image"),GridPlusSetting.layout_disable_link=a("#layout_disable_link"),GridPlusSetting.layout_carousel_rtl=a("#layout_carousel_rtl"),GridPlusSetting.layout_carousel_total_items=a("#layout_carousel_total_items"),GridPlusSetting.layout_carousel_desktop_large_col=a("#layout_carousel_desktop_large_col"),GridPlusSetting.layout_carousel_desktop_large_width=a("#layout_carousel_desktop_large_width"),GridPlusSetting.layout_carousel_desktop_medium_col=a("#layout_carousel_desktop_medium_col"),GridPlusSetting.layout_carousel_desktop_medium_width=a("#layout_carousel_desktop_medium_width"),GridPlusSetting.layout_carousel_desktop_small_col=a("#layout_carousel_desktop_small_col"),GridPlusSetting.layout_carousel_desktop_small_width=a("#layout_carousel_desktop_small_width"),GridPlusSetting.layout_carousel_tablet_col=a("#layout_carousel_tablet_col"),GridPlusSetting.layout_carousel_tablet_width=a("#layout_carousel_tablet_width"),GridPlusSetting.layout_carousel_tablet_small_col=a("#layout_carousel_tablet_small_col"),GridPlusSetting.layout_carousel_tablet_small_width=a("#layout_carousel_tablet_small_width"),GridPlusSetting.layout_carousel_mobile_col=a("#layout_carousel_mobile_col"),GridPlusSetting.layout_carousel_mobile_width=a("#layout_carousel_mobile_width"),GridPlusSetting.layout_carousel_next_text=a("#layout_carousel_next_text"),GridPlusSetting.layout_carousel_prev_text=a("#layout_carousel_prev_text"),GridPlusSetting.layout_carousel_width_ratio=a("#layout_carousel_width_ratio"),GridPlusSetting.layout_carousel_height_ratio=a("#layout_carousel_height_ratio"),GridPlusSetting.layout_loop=a("#layout_loop"),GridPlusSetting.layout_autoplay=a("#layout_autoplay"),GridPlusSetting.layout_autoplay_hover_pause=a("#layout_autoplay_hover_pause"),GridPlusSetting.layout_autoplay_time=a("#layout_autoplay_time"),GridPlusSetting.layout_show_dot=a("#layout_show_dot"),GridPlusSetting.layout_show_nav=a("#layout_show_nav"),GridPlusSetting.layout_justified_row_height=a("#layout_justified_row_height"),GridPlusSetting.layout_justified_margin=a("#layout_justified_margin"),GridPlusSetting.layout_source=a("#layout_source"),GridPlusSetting.source_type=a("#source_type"),GridPlusSetting.layout_category=a("#layout_category"),GridPlusSetting.layout_show_category=a("#layout_show_category"),GridPlusSetting.layout_cate_multi_line=a("#layout_cate_multi_line"),GridPlusSetting.layout_authors=a("#layout_authors"),GridPlusSetting.layout_exclude_ids=a("#layout_exclude_ids"),GridPlusSetting.layout_order=a("#layout_order"),GridPlusSetting.layout_order_by=a("#layout_order_by"),GridPlusSetting.layout_category_color=a("#layout_category_color"),GridPlusSetting.layout_category_hover_color=a("#layout_category_hover_color"),GridPlusSetting.layout_no_image_bg_color=a("#layout_no_image_bg_color"),GridPlusSetting.layout_bg_color=a("#layout_bg_color"),GridPlusSetting.layout_icon_color=a("#layout_icon_color"),GridPlusSetting.layout_icon_hover_color=a("#layout_icon_hover_color"),GridPlusSetting.layout_title_color=a("#layout_title_color"),GridPlusSetting.layout_title_hover_color=a("#layout_title_hover_color"),GridPlusSetting.layout_excerpt_color=a("#layout_excerpt_color"),GridPlusSetting.layout_animation_type=a("#layout_animation_type"),GridPlusSetting.layout_pagination_type=a("#layout_pagination_type"),GridPlusSetting.layout_page_prev_text=a("#layout_page_prev_text"),GridPlusSetting.layout_page_next_text=a("#layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=a("#layout_page_loadmore_text"),"metro"==GridPlusSetting.layout_type.val()&&(GridPlusSetting.layout_item_per_page=a("#metro_layout_item_per_page"),GridPlusSetting.layout_total_items=a("#metro_layout_total_items"),GridPlusSetting.layout_pagination_type=a("#metro_layout_pagination_type"),GridPlusSetting.layout_page_prev_text=a("#metro_layout_page_prev_text"),GridPlusSetting.layout_page_next_text=a("#metro_layout_page_next_text"),GridPlusSetting.layout_page_loadmore_text=a("#metro_layout_page_loadmore_text")),a("optgroup",GridPlusSetting.layout_category).remove(),GridPlusSetting.layout_category.append(a('optgroup[data-post-type="'+GridPlusSetting.layout_source.val()+'"]',"#layout_category_filter").clone()),GridPlusSetting.initSelectize(),GridPlusSetting.layout_source.on("change",function(){var b=GridPlusSetting.layout_source.val();GridPlusSetting.select_categories.destroy(),a("optgroup",GridPlusSetting.layout_category).remove(),GridPlusSetting.layout_category.append(a('optgroup[data-post-type="'+b+'"]',"#layout_category_filter").clone()),GridPlusSetting.initSelectize()}),a(GridPlusSetting.layout_type).on("change",function(){var b=a(this).val();GridPlusSetting.initGridMoveAndResize(b)})},initGridMoveAndResize:function(b){void 0!==GridPlusSetting.grid&&null!=GridPlusSetting.grid&&("grid"!=b&&"masonry"!=b||GridPlusSetting.grid.disable(),"metro"==b&&GridPlusSetting.grid.enable()),"grid"==b?a(".change-ratio",".action-groups").show():a(".change-ratio",".action-groups").hide()},registerEvent:function(){a("a.add-item").on("click",function(){GridPlusSetting.showPopupSkin(function(a){var b=GridPlusSetting.estimateItemInfo(),c=b.width,d=b.height,e=b.system_col,f=b.col;GridPlusSetting.options.width=e,GridPlusSetting.grid.setGridWidth(e,!1),GridPlusSetting.processAddItem(c,d,f,a),GridPlusSetting.processUpdateItemPerPage(1)})}),a("a.change-item-style").on("click",function(){GridPlusSetting.showPopupSkin(function(b){a(".grid-stack-item").each(function(){GridPlusSetting.processInitItemStyle(a(this),b)})})}),a("a.save-layout",".grid-plus-container").off("click").on("click",function(){GridPlusSetting.processSaveGrid(this)}),a("article",".list-skins").each(function(){a(this).append('<a class="select-skin" href="javascript:;"><i class="fa fa-square-o"></i>Select</a>'),a("a.select-skin",this).off("click").on("click",function(){a("a.select-skin").html('<i class="fa fa-square-o"></i>Select'),a(this).html('<i class="fa fa-check-square-o"></i>Selected'),a("article",".list-skins").attr("data-skin-selected",0),a(this).parent().attr("data-skin-selected",1)})}),a("a.generate-layout").on("click",function(){GridPlusUtil.showLoading("Processing generate layout ..."),GridPlusSetting.vars.grid_stack.fadeOut(function(){GridPlusSetting.processGenerateLayout(),GridPlusSetting.vars.grid_stack.fadeIn(function(){GridPlusUtil.closeLoading(0)})})}),a("a.search-layout").on("click",function(){var b=a("input",a(this).parent());b.hasClass("active")?b.removeClass("active"):(b.val(""),b.addClass("active"),setTimeout(function(){b.focus(),b.attr("placeholder","Type grid name and enter to search")},300)),a(b).on("keypress",function(b){if("13"==(b.keyCode?b.keyCode:b.which)){var d=a(this).parent().parent().attr("data-ajax-url"),e=a(this).val();0==GridPlusSetting.is_search&&(GridPlusSetting.is_search=1,GridPlusSetting.processSearch("Searching grid ......",d,e))}})}),a(".refresh-layout").on("click",function(){if(0==GridPlusSetting.is_search){GridPlusSetting.is_search=1;var b=a(this).parent().attr("data-ajax-url");GridPlusSetting.processSearch("Refresh grid ......",b,"")}}),a(".change-ratio",".action-groups").on("click",function(){var b=wp.template("bg-prompt-change-height-dialog"),c=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),d=GridPlusSetting.vars.grid_stack.attr("data-width-ratio");void 0!==c&&""!=c||(c=1),void 0!==d&&""!=d||(d=1),a("body").append(b({height_ratio:c,width_ratio:d})),a("a.close-popup").on("click",function(){a(".bg-popup-change-height").remove()}),a("a#apply_change_height").on("click",function(){var b=a("#txt_height").val(),c=a("#txt_width").val(),d=a(".grid-stack-item-content",".grid-stack-item:first-child").width(),e=0,f=0;""!=b&&""!=c&&(GridPlusSetting.vars.grid_stack.attr("data-height-ratio",b),GridPlusSetting.vars.grid_stack.attr("data-width-ratio",c),d=parseInt(d),b=parseInt(b),c=parseInt(c),f=Math.floor(d*(b/c)),e=f/GridPlusSetting.options.cellHeight,GridPlusSetting.processChangeHeight(e)),a(".bg-popup-change-height").remove()})}),GridPlusSetting.layout_name.keyup(function(){GridPlusSetting.layout_shortcode.text('[grid_plus name="'+a(this).val()+'"]')}),GridPlusSetting.registerChangeTab()},initSelectize:function(){var b,c={plugins:["remove_button","drag_drop"],searchField:"text",delimiter:",",persist:!1};a("select:not(.manual)",".grid-plus-wrap").each(function(){b=a(this).attr("data-selected"),c.items=void 0!==b?b.split(","):[],a(this).selectize(c)}),b=GridPlusSetting.layout_category.attr("data-selected"),c.items=void 0!==b?b.split(","):[],GridPlusSetting.select_categories=GridPlusSetting.layout_category.selectize(c),void 0!==GridPlusSetting.select_categories[0]&&(GridPlusSetting.select_categories=GridPlusSetting.select_categories[0].selectize),GridPlusSetting.layout_exclude_ids.selectize({plugins:["remove_button"],valueField:"value",labelField:"label",searchField:"label",delimiter:",",options:[],create:!1,load:function(b,c){if(!b.length)return c();a.ajax({url:GridPlusSetting.layout_exclude_ids.attr("data-url")+"?action=grid_plus_get_posts",type:"GET",data:{title:b,post_type:GridPlusSetting.layout_source.val()},error:function(){c()},success:function(b){c(a.parseJSON(b))}})}})},initSaveCtrS:function(){a(window).bind("keydown",function(b){if((b.ctrlKey||b.metaKey)&&"s"===String.fromCharCode(b.which).toLowerCase())return b.preventDefault(),a("a.save-layout","#layout-config").trigger("click"),!1})},initDepend:function(){a("[data-depend-control]").each(function(){var b=a(this).attr("data-depend-control"),c=a("#"+b),d="",e=","+a(this).attr("data-depend-value")+",";void 0!==c&&c.length>0&&(d=c.val(),c.is(":checkbox")&&(d=c.is(":checked")),c.is(":radio")&&(d=a("#"+b+":checked").val()),e.indexOf(","+d+",")>=0?a(this).css({display:"inline-block"}):a(this).css({display:"none"}),c.off("change").on("change",function(){GridPlusSetting.initDepend()}))})},initGridStack:function(b,c,d,e){var g=(a('select[name="padding"]').val(),GridPlusSetting.estimateItemInfo()),h=g.width,i=g.height,j=g.system_col;e=parseInt(e),GridPlusSetting.options.verticalMargin=e,GridPlusSetting.options.width=j,GridPlusSetting.vars.grid_stack.attr("data-gutter","gutter-"+e),GridPlusSetting.vars.grid_stack.attr("data-layout",b),GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"),GridPlusSetting.grid.verticalMargin(e,!0),GridPlusSetting.grid.removeAll();for(var k=0;k<d;k++)GridPlusSetting.processAddItem(h,i,c)},initGridStackEdit:function(b,c,d,e,f,g){var h=GridStackUI.Utils.sort(b,1),i=null;GridPlusSetting.vars.grid_stack.attr("data-height-ratio",e),GridPlusSetting.vars.grid_stack.attr("data-width-ratio",f),GridPlusSetting.vars.grid_stack.attr("data-gutter","gutter-"+c),GridPlusSetting.vars.grid_stack.attr("data-layout",g),"grid"==g||"masonry"==g||5==d?(GridPlusSetting.options.width=d,GridPlusSetting.vars.grid_stack.addClass("grid-stack-"+d)):GridPlusSetting.options.width=12,GridPlusSetting.options.verticalMargin=c,GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"),GridPlusSetting.grid.verticalMargin(c,!1),GridPlusSetting.grid.removeAll(),_.each(h,function(b){i=GridPlusSetting.grid.addWidget(a('<div><div class="grid-stack-item-content" /></div>'),b.x,b.y,b.width,b.height),GridPlusSetting.registerRemoveGridStackItem(i),GridPlusSetting.registerChangeItemStyle(i),GridPlusSetting.processInitItemStyle(i,b.skin)},this)},registerRemoveGridStackItem:function(b){a(".grid-stack-item-content",b).append('<a class="remove-item" title="Remove item"><i class="fa fa-trash-o"></i></a>'),a("a",b).off("click").on("click",function(){GridPlusSetting.grid.removeWidget(b),GridPlusSetting.processUpdateItemPerPage(-1)})},registerChangeItemStyle:function(b){a(".grid-stack-item-content",b).append('<div class="change-style"><a href="javascript:;" title="Change skin"><i class="fa fa-paint-brush"></i></a>'),a(".change-style a",b).off("click").on("click",function(){GridPlusSetting.showPopupSkin(function(a){GridPlusSetting.processInitItemStyle(b,a)})})},registerChangeTab:function(){var b=".grid-plus-wrap .nav-tabs",c=".grid-plus-wrap .content-wrap";a("a",b).on("click",function(){var d=a(this).attr("data-section-id");if(void 0!==d){a("li",b).removeClass("tab-current");void 0!==a(this).attr("data-external")?a('a[data-section-id="'+d+'"]',b).parent().addClass("tab-current"):a(this).parent().addClass("tab-current"),a("section",c).hide(),a("#"+d,c).show()}})},estimateItemInfo:function(){var b=parseInt(GridPlusSetting.layout_col.val()),c=Math.floor(12/b),d=Math.floor(12/b),e=GridPlusSetting.layout_type.val(),f=GridPlusSetting.layout_gutter.val(),g=a(".grid-stack-container").width(),h=Math.floor(parseInt(g)/b),i=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),j=GridPlusSetting.vars.grid_stack.attr("data-width-ratio"),k=12;if("grid"!=e&&"masonry"!=e&&5!=b||(c=1,k=b),"grid"==e)d=void 0!==i&&void 0!==j&&""!=j&&""!=i?Math.floor(h*(i/j)/GridPlusSetting.options.cellHeight):Math.floor(h/GridPlusSetting.options.cellHeight);else switch(b){case 2:d=f>0?15:40;break;case 3:case 4:d=f>0?15:30;break;case 5:case 6:d=f>0?10:20}return{width:c,height:d,system_col:k,col:b}},processSaveGrid:function(b){if("carousel"!=GridPlusSetting.layout_type.val()&&"justified"!=GridPlusSetting.layout_type.val()){if(void 0===GridPlusSetting.grid||0==a(".grid-stack-item",".grid-stack").length)return void GridPlusUtil.popupAlert("fa fa-exclamation-triangle","Please generate layout before save");if(!GridPlusSetting.isValidateLayout())return void GridPlusUtil.popupAlert("fa fa-exclamation-triangle","Please generate layout when change layout type before save")}GridPlusUtil.showLoading("Save Grid Settings");var d,e,f,g,h,i,c=a('article[data-skin-selected="1"]',".list-skins");"carousel"==GridPlusSetting.layout_type.val()&&(c.length<=0&&(c=a("article:first",".list-skins")),c.length>0&&(d=c.closest(".skin-item").attr("data-skin"),e=c.closest(".skin-item").attr("data-skin-template"),f=c.closest(".skin-item").attr("data-skin-css"))),"justified"==GridPlusSetting.layout_type.val()&&(c.length<=0&&(c=a("article:first",".list-skins")),c.length>0&&(g=c.closest(".skin-item").attr("data-skin"),h=c.closest(".skin-item").attr("data-skin-template"),i=c.closest(".skin-item").attr("data-skin-css")));var j=GridPlusSetting.layout_carousel_next_text.val(),k=GridPlusSetting.layout_carousel_prev_text.val();void 0!==j&&(j=j.replace(/"/g,"&quot;")),void 0!==k&&(k=k.replace(/"/g,"&quot;"));var l=GridPlusSetting.vars.grid_stack.attr("data-height-ratio"),m=GridPlusSetting.vars.grid_stack.attr("data-width-ratio");void 0!==l&&""!=l||(l=1),void 0!==m&&""!=m||(m=1);var n=GridPlusSetting.vars.grid_stack.height(),o=_.map(a(".grid-stack > .grid-stack-item"),function(b){b=a(b);var c=b.data("_gridstack_node");return{x:c.x,y:c.y,width:c.width,height:c.height,skin:b.attr("data-skin"),skin_css:b.attr("data-skin-css"),template:b.attr("data-skin-template")}},this),p={id:GridPlusSetting.layout_id.val(),name:GridPlusSetting.layout_name.val(),height:n,height_ratio:l,width_ratio:m,type:GridPlusSetting.layout_type.val(),columns:GridPlusSetting.layout_col.val(),gutter:GridPlusSetting.layout_gutter.val(),item_per_page:GridPlusSetting.layout_item_per_page.val(),total_item:GridPlusSetting.layout_total_items.val(),fix_item_height:GridPlusSetting.layout_fix_item_height.is(":checked"),crop_image:GridPlusSetting.layout_crop_image.is(":checked"),disable_link:GridPlusSetting.layout_disable_link.is(":checked"),loop:GridPlusSetting.layout_loop.is(":checked"),justified_row_height:GridPlusSetting.layout_justified_row_height.val(),justified_margin:GridPlusSetting.layout_justified_margin.val(),justified_skin:g,justified_skin_template:h,justified_skin_css:i,carousel_rtl:GridPlusSetting.layout_carousel_rtl.is(":checked"),carousel_skin:d,carousel_skin_template:e,carousel_skin_css:f,carousel_height_ratio:GridPlusSetting.layout_carousel_height_ratio.val(),carousel_width_ratio:GridPlusSetting.layout_carousel_width_ratio.val(),carousel_next_text:j,carousel_prev_text:k,carousel_total_items:GridPlusSetting.layout_carousel_total_items.val(),carousel_desktop_large_col:GridPlusSetting.layout_carousel_desktop_large_col.val(),carousel_desktop_large_width:GridPlusSetting.layout_carousel_desktop_large_width.val(),carousel_desktop_medium_col:GridPlusSetting.layout_carousel_desktop_medium_col.val(),carousel_desktop_medium_width:GridPlusSetting.layout_carousel_desktop_medium_width.val(),carousel_desktop_small_col:GridPlusSetting.layout_carousel_desktop_small_col.val(),carousel_desktop_small_width:GridPlusSetting.layout_carousel_desktop_small_width.val(),carousel_tablet_col:GridPlusSetting.layout_carousel_tablet_col.val(),carousel_tablet_width:GridPlusSetting.layout_carousel_tablet_width.val(),carousel_tablet_small_col:GridPlusSetting.layout_carousel_tablet_small_col.val(),carousel_tablet_small_width:GridPlusSetting.layout_carousel_tablet_small_width.val(),carousel_mobile_col:GridPlusSetting.layout_carousel_mobile_col.val(),carousel_mobile_width:GridPlusSetting.layout_carousel_mobile_width.val(),autoplay:GridPlusSetting.layout_autoplay.is(":checked"),autoplay_hover_pause:GridPlusSetting.layout_autoplay_hover_pause.is(":checked"),autoplay_time:GridPlusSetting.layout_autoplay_time.val(),show_dot:GridPlusSetting.layout_show_dot.is(":checked"),show_nav:GridPlusSetting.layout_show_nav.is(":checked"),animation_type:GridPlusSetting.layout_animation_type.val(),pagination_type:GridPlusSetting.layout_pagination_type.val(),page_next_text:GridPlusSetting.layout_page_next_text.val(),page_prev_text:GridPlusSetting.layout_page_prev_text.val(),page_loadmore_text:GridPlusSetting.layout_page_loadmore_text.val(),category_color:GridPlusSetting.layout_category_color.val(),category_hover_color:GridPlusSetting.layout_category_hover_color.val(),no_image_background_color:GridPlusSetting.layout_no_image_bg_color.val(),background_color:GridPlusSetting.layout_bg_color.val(),icon_color:GridPlusSetting.layout_icon_color.val(),icon_hover_color:GridPlusSetting.layout_icon_hover_color.val(),title_color:GridPlusSetting.layout_title_color.val(),title_hover_color:GridPlusSetting.layout_title_hover_color.val(),excerpt_color:GridPlusSetting.layout_excerpt_color.val(),custom_css:GridPlusSetting.layout_custom_css.getValue()},q={post_type:GridPlusSetting.layout_source.val(),source_type:GridPlusSetting.source_type.val(),categories:GridPlusSetting.layout_category.val(),show_category:GridPlusSetting.layout_show_category.val(),cate_multi_line:GridPlusSetting.layout_cate_multi_line.is(":checked"),authors:GridPlusSetting.layout_authors.val(),exclude_ids:GridPlusSetting.layout_exclude_ids.val(),order:GridPlusSetting.layout_order.val(),order_by:GridPlusSetting.layout_order_by.val()},r=a(b).parent().attr("data-ajax-url");o=_.sortBy(o,function(a){return a.y}),o=GridStackUI.Utils.sort(o),a.ajax({url:r,type:"POST",data:{action:"grid_plus_save_layout",grid_config:p,grid_data_source:q,grid_layout:o},success:function(a){a=JSON.parse(a),void 0!==a.code&&"-1"==a.code?(GridPlusUtil.closeLoading(0),GridPlusUtil.popupAlert("fa fa-exclamation-triangle",a.message)):(GridPlusSetting.layout_id.val(a.id),GridPlusSetting.layout_shortcode.val('[grid_plus name="'+GridPlusSetting.layout_name.val()+'"]'),GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Grid setting saved"),GridPlusUtil.closeLoading())},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when save information"),GridPlusUtil.closeLoading()}})},processGenerateLayout:function(){var b=a("#layout_name").val(),c=a("#layout_type").val(),d=a("#layout_col").val(),e=a("#layout_item_per_page").val(),f=a("#layout_total_items").val(),g=a("#layout_gutter").val(),h=a("#layout_pagination_type").val(),i="grid-stack-"+d;"show_all"==h&&(e=2*d),console.log(e),a("#grid_id",".grid-plus-layout").val(),a("#grid_name",".grid-plus-layout").val(b),a("#grid_type",".grid-plus-layout").val(c),a("#grid_col",".grid-plus-layout").val(d),a("#grid_gutter",".grid-plus-layout").val(g),a("#grid_item_per_page",".grid-plus-layout").val(e),a("#grid_items",".grid-plus-layout").val(f);for(var j=1;j<=12;j++)GridPlusSetting.vars.grid_stack.removeClass("grid-stack-"+j);"metro"==c&&5!=d||GridPlusSetting.vars.grid_stack.addClass(i),d=parseInt(d),e=parseInt(e),GridPlusSetting.initGridStack(c,d,e,g),GridPlusSetting.initGridMoveAndResize(c)},processAddItem:function(b,c,d,e){var f=a(".grid-stack-item:last-child"),g=0,h=0,i=b,j=0,k=0,l=a(".grid-stack-item").length;void 0!==f&&f.length>0&&(g=f.attr("data-gs-y"),h=f.attr("data-gs-x"),i=f.attr("data-gs-width"),l%d==0?(j=0,k=Math.floor(l/d)*c):(k=g,j=parseInt(h)+parseInt(i)));var m={x:j,y:k,width:b,height:c};void 0!==GridPlusSetting.grid&&null!=GridPlusSetting.grid||(GridPlusSetting.vars.grid_stack.gridstack(GridPlusSetting.options),GridPlusSetting.grid=GridPlusSetting.vars.grid_stack.data("gridstack"));var n=GridPlusSetting.grid.addWidget(a('<div><div class="grid-stack-item-content stack-item-has-bg"/></div>'),m.x,m.y,m.width,m.height,!1);if(void 0===e||""==e){var o=a('article[data-skin-selected="1"]',".list-skins");e="thumbnail",o.length>0&&(e=o.closest(".skin-item").attr("data-skin"))}GridPlusSetting.registerRemoveGridStackItem(n),GridPlusSetting.registerChangeItemStyle(n),GridPlusSetting.processInitItemStyle(n,e)},processInitItemStyle:function(b,c){var d=a(".grid-stack-item-content",b),e=a('li[data-skin="'+c+'"]',".list-skins"),f=a("article",e),g="",h="",i="",j="";0==f.length&&(e=a("li:first-child",".list-skins"),f=a("article:first-child",".list-skins")),g=e.attr("data-skin"),i=e.attr("data-skin-css"),h=e.attr("data-skin-template"),f=f.clone(),j=a(".thumbnail-image",f).attr("data-img"),void 0!==j&&""!=j&&(a(".thumbnail-image img",f).remove(),a(".thumbnail-image",f).css("background-image",'url("'+j+'")')),a("a.select-skin",f).remove(),b.fadeOut(function(){a("article",b).length>0&&a("article",b).remove(),b.attr("data-skin",g),b.attr("data-skin-css",i),b.attr("data-skin-template",h),d.append(f),b.fadeIn()})},processUpdateItemPerPage:function(b){var c=a("#layout_item_per_page").val();a("#layout_item_per_page").val(parseInt(c)+b),a("#grid_item_per_page",".grid-plus-layout").val(parseInt(c)+b)},processEditLayout:function(){GridPlusUtil.showLoading("Loading layout information"),a.ajax({url:grid_script_data.ajax_url,type:"POST",data:{action:"grid_plus_get_info",grid_id:grid_script_data.grid_id},success:function(b){var c=JSON.parse(b);if("-1"==typeof c.code)return GridPlusUtil.closeLoading(0),void GridPlusUtil.popupAlert("fa fa-exclamation-triangle",c.message);if(void 0!==c.grid_config&&"carousel"==c.grid_config.type){var d=a('.skin-item[data-skin="'+c.grid_config.carousel_skin+'"]',".list-skins");d.length>0&&(a("article",d).attr("data-skin-selected",1),a(".select-skin i",d).removeClass("fa fa-square-o").addClass("fa fa-check-square-o"))}if(void 0!==c.grid_config&&"justified"==c.grid_config.type){var d=a('.skin-item[data-skin="'+c.grid_config.justified_skin+'"]',".list-skins");d.length>0&&(a("article",d).attr("data-skin-selected",1),a(".select-skin i",d).removeClass("fa fa-square-o").addClass("fa fa-check-square-o"))}GridPlusSetting.initGridStackEdit(c.grid_layout,c.grid_config.gutter,c.grid_config.columns,c.grid_config.height_ratio,c.grid_config.width_ratio,c.grid_config.type),GridPlusSetting.initGridMoveAndResize(c.grid_config.type),GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Information has been loaded"),GridPlusUtil.closeLoading(500)},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when load information"),GridPlusUtil.closeLoading()}})},processRebindListGrid:function(b){var c=wp.template("list-grid-template");a("tr","#table_list_grid tbody").empty(),void 0!==b&&b.length>0&&a("tbody","#table_list_grid").append(c(b)),GridPlusSetting.registerGridAction()},processSearch:function(b,c,d){GridPlusUtil.showLoading(b),a.ajax({url:c,type:"POST",data:{action:"grid_plus_get_list",grid_name:d},success:function(a){GridPlusUtil.changeLoadingStatus("fa fa-check-square-o","Binding grid"),GridPlusUtil.closeLoading(500),a=JSON.parse(a),GridPlusSetting.processRebindListGrid(a),GridPlusSetting.is_search=0},error:function(){GridPlusUtil.changeLoadingStatus("fa fa-exclamation-triangle","Have error when delete information"),GridPlusUtil.closeLoading(),GridPlusSetting.is_search=0}})},processChangeHeight:function(b){var c=0,d=0,e=0,f=0;a(".grid-stack-item").each(function(){f=parseInt(a(this).attr("data-gs-height")),c=b-f,d=parseInt(a(this).attr("data-gs-y")),e=parseInt(a(this).attr("data-gs-width")),a(this).attr("data-gs-height",b),d>0&&a(this).attr("data-gs-y",d+c),void 0!==GridPlusSetting.grid&&GridPlusSetting.grid.resize(a(this),e,b)}),void 0!==GridPlusSetting.grid&&(GridPlusSetting.grid.batchUpdate(),GridPlusSetting.grid.commit())},isValidateLayout:function(){var b=GridPlusSetting.layout_type.val(),d=(GridPlusSetting.layout_col,a(".grid-stack-item"));if("grid"==b||"masonry"==b)for(var e=0;e<d.length;e++)if(a(d[e]).prev().length>0&&parseInt(a(d[e]).attr("data-gs-width"))!=parseInt(a(d[e]).prev().attr("data-gs-width")))return!1;return!0},showPopupSkin:function(b){var c=a("#list_skins").clone(!0),d=a('<div class="grid-plus-container"></div>'),e=a('<div class="bg-popup-skins"></div>');a("li",c).removeClass("col-md-3").addClass("col-md-4"),d.append(c),e.append(d),d.append('<a href="javascript:;" class="close-popup"><i class="fa fa-times"></i></a>'),a(".select-skin i",d).removeClass("fa fa-check-square-o").addClass("fa fa-square-o"),a("body").append(e),a(".grid-plus-container .grid-plus-layout",e).perfectScrollbar({wheelSpeed:.5,suppressScrollX:!0}),a("a.close-popup",e).on("click",function(){e.remove()}),a("a.select-skin",e).off("click").on("click",function(c){return e.remove(),b&&b(a(this).closest(".skin-item").attr("data-skin")),c.preventDefault(),!1})},animation:function(){a("#layout_animation_type").on("change",function(){var b=a(".animation-wrap");b.attr("class","animation-wrap animated "+a(this).val()),setTimeout(function(){b.attr("class","animation-wrap")},1e3)}),a(".preview-animation").on("click",function(){a("#layout_animation_type").trigger("change")})}},a(document).ready(function(){GridPlusSetting.init()})}(jQuery);